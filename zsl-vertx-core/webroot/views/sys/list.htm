<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
	<!-- BEGIN HEADER -->
	<!-- END HEADER -->
	<!-- BEGIN BODY -->
	<!-- DOC: Apply "page-header-fixed-mobile" and "page-footer-fixed-mobile" class to body element to force fixed header or footer in mobile devices -->
	<!-- DOC: Apply "page-sidebar-closed" class to the body and "page-sidebar-menu-closed" class to the sidebar menu element to hide the sidebar by default -->
	<!-- DOC: Apply "page-sidebar-hide" class to the body to make the sidebar completely hidden on toggle -->
	<!-- DOC: Apply "" class to the body element to make the logo hidden on sidebar toggle -->
	<!-- DOC: Apply "page-sidebar-hide" class to body element to completely hide the sidebar on sidebar toggle -->
	<!-- DOC: Apply "page-sidebar-fixed" class to have fixed sidebar -->
	<!-- DOC: Apply "page-footer-fixed" class to the body element to have fixed footer -->
	<!-- DOC: Apply "page-sidebar-reversed" class to put the sidebar on the right side -->
	<!-- DOC: Apply "page-full-width" class to the body element to have full width page without the sidebar menu -->
	<body class="page-header-fixed page-sidebar-closed-hide-logo page-sidebar-closed-hide-logo">
	
		<!-- BEGIN HEADER -->	
		<!-- END HEADER -->
	
		<div class="clearfix"></div>
		
		<!-- BEGIN CONTAINER -->
		<div class="page-container">
			<!-- BEGIN SIDEBAR -->
			<!-- END SIDEBAR -->
			
			<!-- BEGIN CONTENT -->
				<div class="page-content-wrapper">
					<div class="page-content" >
						<div class="page-head">
							<!-- BEGIN PAGE TITLE -->
							<div class="page-title">
								<h1><i class="icon-grid" style="font-size: 20px;"></i>&nbsp;   </h1>
							</div>
							<!-- END PAGE TITLE -->
						</div>
						<!-- BEGIN PAGE HEADER-->
						<ul class="page-breadcrumb breadcrumb">
							<li>
								
								<a href="/admin/common/main.jhtml"></a>
								<i class="fa fa-circle"></i>
							</li>
							<li>
								<a href="javascript:;">_%{message("admin.role.contentGroup")}</a><i class="fa fa-circle"></i>
							</li>
							<li>
								<a href="javascript:;"></a>
							</li>
						</ul>
						<!-- END PAGE HEADER-->
						<!-- BEGIN PAGE CONTENT-->
							<div class="row">
								<div class="col-md-12">
									<div class="portlet light bordered">
										<div class="portlet-title">
											<div class="caption">
												<i class="fa fa-globe"></i>
											</div>
											<div class="actions">
												<a href="/admin/admin/add.jhtml" class="btn btn-default btn-sm"> <i class="fa fa-plus"></i>  </a>
												<a href="javascript:;" onclick="window.print();" class="btn btn-default btn-sm"> <i class="fa fa-print"></i> _%{message("admin.common.print")} </a>
												<a href="javascript:;" class="btn btn-default btn-sm disabled" id="deleteButton"> <i class="fa fa-trash-o"></i> _%{message("admin.common.delete")}  </a>
											</div>
										</div>
										<form id="listForm" action="list.jhtml" method="get">
											<div class="portlet-body">
												<div class="table-toolbar">
													
												</div>
												<div id="sample_1_wrapper" class="dataTables_wrapper no-footer"><div class="table-scrollable">
													<table class="table table-striped table-bordered table-hover dataTable no-footer" id="table_list" role="grid" aria-describedby="sample_2_info">
														<thead>
															<tr role="row">
																<th class="table-checkbox sorting_disabled" rowspan="1" colspan="1" style="width: 24px;">
																	<span><input type="checkbox" class="group-checkable" data-set="#table_list .checkboxes"></span>
																</th>
																<th  style="width: 100px;">
															 		_%{message("Admin.username")}
																</th>
																<th style="width: 169px;">
																 	_%{message("Admin.name")}
																</th>
																<th style="width: 100px;">
															 		_%{message("Admin.loginDate")}
																</th>
																<th style="width: 100px;">
															 		_%{message("Admin.loginIp")}
																</th>
																<th style="width: 100px;">
															 		_%{message("admin.admin.status")}
																</th>
																<th style="width: 100px;">
															 		_%{message("admin.common.createDate")}
																</th>
																<th style="width: 200px;">
																	_%{message("admin.common.handle")}
																</th>
															</tr>
														</thead>
														<tbody>
															[#list page.content as admin]
																<tr class="gradeX [#if (admin_index+1) % 2 != 0]odd[#else]even[/#if]" role="row">
																	<td>
																		<span><input type="checkbox" name="ids" class="checkboxes" value="_%{admin.id}" ></span>
																	</td>
																	<td >
																		_%{admin.username}
																	</td>
																	<td>
																		_%{admin.nickname}
																	</td>
																	<td>
																		[#if admin.loginDate??]
																			<span title="_%{admin.loginDate?string("yyyy-MM-dd HH:mm:ss")}">_%{admin.loginDate}</span>
																		[#else]
																			-
																		[/#if]
																	</td>
																	<td>
																		_%{(admin.loginIp)!"-"}
																	</td>
																	<td>
																		[#if !admin.isEnabled]
																			<span class="label label-sm label-danger">_%{message("admin.admin.disabled")}</span>
																		[#elseif admin.isLocked]
																			<span class="label label-sm label-warning"> _%{message("admin.admin.locked")} </span>
																		[#else]
																			<span class="label label-success">_%{message("admin.admin.normal")}</span>
																		[/#if]
																	</td>
																	<td>
																		<span title="_%{admin.createDate?string("yyyy-MM-dd HH:mm:ss")}">_%{admin.createDate}</span>
																	</td>
																	<td>
																		<a href="/admin/admin/edit/_%{admin.id}.jhtml" class="btn default btn-xs purple"> <i class="fa fa-edit"></i> _%{message("admin.common.edit")} </a>
																		
																		<a href="javascript:;" class="btn default btn-xs black single-delete" val="_%{admin.id}"> <i class="fa fa-trash-o"></i> _%{message("admin.common.delete")} </a>
																		
																		<a href="/admin/admin/view/_%{admin.id}.jhtml" class="btn default btn-xs green-stripe"> _%{message("admin.common.view")} </a>
																
																	</td>
																</tr>
															[/#list]
														</tbody>
													</table>
												</div>
												[@pagination pageNumber = page.pageNumber totalPages = page.totalPages]
													[#include "/admin/include/pagination.ftl"]
												[/@pagination]
											</div>
										<form>
									</div>
								</div>
							</div>
						<!-- END PAGE CONTENT-->
					</div>
				</div>
			<!-- END CONTENT -->
			
			
			<!-- BEGIN QUICK SIDEBAR -->
				
			<!-- END QUICK SIDEBAR -->
		</div>
		<!-- END CONTAINER -->
		
		<!-- BEGIN FOOTER -->
			[#include "/admin/include/footer.ftl"]
		<!-- END FOOTER -->
		
			
		<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
			[#include "/admin/include/foot.ftl"]
			<link rel="stylesheet" type="text/css" href="/resources/plugin/metronic/global/plugins/bootstrap-toastr/toastr.min.css"/>
			<script src="/resources/plugin/metronic/global/plugins/bootstrap-toastr/toastr.min.js"></script>
			<script src="/resources/plugin/metronic/global/plugins/bootbox/bootbox.min.js" type="text/javascript"></script>
			
		<!-- END JAVASCRIPTS -->
			<script>
				$(document).ready(function(){
					var $listForm = $("#listForm");
					var $pageTotal = $("#pageTotal");
					var $pageSize = $("#pageSize");
					var $pageNumber = $("#pageNumber");
					// 页码跳转
					$.pageSkip = function(pageNumber) {
						$pageNumber.val(pageNumber);
						$listForm.submit();
						return false;
					}
					bootbox.setDefaults({locale:framework.locale});
					
					var table = $('#table_list');
					var $deleteButton = $("#deleteButton");
					var $singledelete = $(".single-delete");

			        table.find('.group-checkable').click(function () {
			            var set = jQuery(this).attr("data-set");
			            var checked = jQuery(this).is(":checked");
			            if(checked){
			           	 	$deleteButton.removeClass("disabled") ;
			            } else{
			           	 	$deleteButton.addClass("disabled");
			            }
			            jQuery(set).each(function () {
			                if (checked) {
			                    $(this).attr("checked", true).parent().addClass('checked');
			                } else {
			                	
			                    $(this).attr("checked", false).parent().removeClass('checked');
			                }
			            });
			        });
			        
			        
			        table.find(".checkboxes").click(function(){
						if (table.find("input[name='ids']:checked").size() > 0) {
							$deleteButton.removeClass("disabled");
						} else {
							table.find('.group-checkable').attr("checked", false).parent().removeClass('checked');
							$deleteButton.addClass("disabled");
						}
			        });
			        
			        // 删除
					$deleteButton.click( function() {
						var $this = $(this);
						if ($this.hasClass("disabled")) {
							return false;
						}
						var $checkedIds = jQuery(table.find('.group-checkable').attr("data-set"));
						bootbox.confirm(message("admin.dialog.deleteConfirm"), function(result) {
						 	if(result){
						 		$.ajax({
									url: "delete.jhtml",
									type: "POST",
									data: $checkedIds.serialize(),
									dataType: "json",
									cache: false,
									success: function(message) {
										toastr[message.type](message.content);
										if (message.type == "success") {
											window.setTimeout(function() {
												window.location.reload(true);
											}, 3000);
										}
									}
								});
						 	}
		                }); 
					});
					
					$singledelete.click(function(){
						var id = $(this).attr("val");
						bootbox.confirm(message("admin.dialog.deleteConfirm"), function(result) {
						 	if(result){
						 		$.ajax({
									url: "delete.jhtml",
									type: "POST",
									data: {ids:id},
									dataType: "json",
									cache: false,
									success: function(message) {
										toastr[message.type](message.content);
										if (message.type == "success") {
											window.setTimeout(function() {
												window.location.reload(true);
											}, 3000);
										}
									}
								});
						 	}
		                }); 
					});
				});
			</script>
	</body>
<!-- END BODY -->
</html>
