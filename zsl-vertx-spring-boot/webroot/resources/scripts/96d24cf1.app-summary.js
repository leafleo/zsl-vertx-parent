var Handlebars=function(){var a=function(){"use strict";function a(a){this.string=a}var b;return a.prototype.toString=function(){return""+this.string},b=a}(),b=function(a){"use strict";function b(a){return h[a]||"&amp;"}function c(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}function d(a){return a instanceof g?a.toString():a||0===a?(a=""+a,j.test(a)?a.replace(i,b):a):""}function e(a){return a||0===a?m(a)&&0===a.length?!0:!1:!0}var f={},g=a,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,j=/[&<>"'`]/;f.extend=c;var k=Object.prototype.toString;f.toString=k;var l=function(a){return"function"==typeof a};l(/x/)&&(l=function(a){return"function"==typeof a&&"[object Function]"===k.call(a)});var l;f.isFunction=l;var m=Array.isArray||function(a){return a&&"object"==typeof a?"[object Array]"===k.call(a):!1};return f.isArray=m,f.escapeExpression=d,f.isEmpty=e,f}(a),c=function(){"use strict";function a(a,b){var d;b&&b.firstLine&&(d=b.firstLine,a+=" - "+d+":"+b.firstColumn);for(var e=Error.prototype.constructor.call(this,a),f=0;f<c.length;f++)this[c[f]]=e[c[f]];d&&(this.lineNumber=d,this.column=b.firstColumn)}var b,c=["description","fileName","lineNumber","message","name","number","stack"];return a.prototype=new Error,b=a}(),d=function(a,b){"use strict";function c(a,b){this.helpers=a||{},this.partials=b||{},d(this)}function d(a){a.registerHelper("helperMissing",function(a){if(2===arguments.length)return void 0;throw new h("Missing helper: '"+a+"'")}),a.registerHelper("blockHelperMissing",function(b,c){var d=c.inverse||function(){},e=c.fn;return m(b)&&(b=b.call(this)),b===!0?e(this):b===!1||null==b?d(this):l(b)?b.length>0?a.helpers.each(b,c):d(this):e(b)}),a.registerHelper("each",function(a,b){var c,d=b.fn,e=b.inverse,f=0,g="";if(m(a)&&(a=a.call(this)),b.data&&(c=q(b.data)),a&&"object"==typeof a)if(l(a))for(var h=a.length;h>f;f++)c&&(c.index=f,c.first=0===f,c.last=f===a.length-1),g+=d(a[f],{data:c});else for(var i in a)a.hasOwnProperty(i)&&(c&&(c.key=i,c.index=f,c.first=0===f),g+=d(a[i],{data:c}),f++);return 0===f&&(g=e(this)),g}),a.registerHelper("if",function(a,b){return m(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||g.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})}),a.registerHelper("with",function(a,b){return m(a)&&(a=a.call(this)),g.isEmpty(a)?void 0:b.fn(a)}),a.registerHelper("log",function(b,c){var d=c.data&&null!=c.data.level?parseInt(c.data.level,10):1;a.log(d,b)})}function e(a,b){p.log(a,b)}var f={},g=a,h=b,i="1.3.0";f.VERSION=i;var j=4;f.COMPILER_REVISION=j;var k={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};f.REVISION_CHANGES=k;var l=g.isArray,m=g.isFunction,n=g.toString,o="[object Object]";f.HandlebarsEnvironment=c,c.prototype={constructor:c,logger:p,log:e,registerHelper:function(a,b,c){if(n.call(a)===o){if(c||b)throw new h("Arg not supported with multiple helpers");g.extend(this.helpers,a)}else c&&(b.not=c),this.helpers[a]=b},registerPartial:function(a,b){n.call(a)===o?g.extend(this.partials,a):this.partials[a]=b}};var p={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(a,b){if(p.level<=a){var c=p.methodMap[a];"undefined"!=typeof console&&console[c]&&console[c].call(console,b)}}};f.logger=p,f.log=e;var q=function(a){var b={};return g.extend(b,a),b};return f.createFrame=q,f}(b,c),e=function(a,b,c){"use strict";function d(a){var b=a&&a[0]||1,c=m;if(b!==c){if(c>b){var d=n[c],e=n[b];throw new l("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new l("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){if(!b)throw new l("No environment passed to template");var c=function(a,c,d,e,f,g){var h=b.VM.invokePartial.apply(this,arguments);if(null!=h)return h;if(b.compile){var i={helpers:e,partials:f,data:g};return f[c]=b.compile(a,{data:void 0!==g},b),f[c](d,i)}throw new l("The partial "+c+" could not be compiled when running in runtime-only mode")},d={escapeExpression:k.escapeExpression,invokePartial:c,programs:[],program:function(a,b,c){var d=this.programs[a];return c?d=g(a,b,c):d||(d=this.programs[a]=g(a,b)),d},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c={},k.extend(c,b),k.extend(c,a)),c},programWithDepth:b.VM.programWithDepth,noop:b.VM.noop,compilerInfo:null};return function(c,e){e=e||{};var f,g,h=e.partial?e:b;e.partial||(f=e.helpers,g=e.partials);var i=a.call(d,h,c,f,g,e.data);return e.partial||b.VM.checkRevision(d.compilerInfo),i}}function f(a,b,c){var d=Array.prototype.slice.call(arguments,3),e=function(a,e){return e=e||{},b.apply(this,[a,e.data||c].concat(d))};return e.program=a,e.depth=d.length,e}function g(a,b,c){var d=function(a,d){return d=d||{},b(a,d.data||c)};return d.program=a,d.depth=0,d}function h(a,b,c,d,e,f){var g={partial:!0,helpers:d,partials:e,data:f};if(void 0===a)throw new l("The partial "+b+" could not be found");return a instanceof Function?a(c,g):void 0}function i(){return""}var j={},k=a,l=b,m=c.COMPILER_REVISION,n=c.REVISION_CHANGES;return j.checkRevision=d,j.template=e,j.programWithDepth=f,j.program=g,j.invokePartial=h,j.noop=i,j}(b,c,d),f=function(a,b,c,d,e){"use strict";var f,g=a,h=b,i=c,j=d,k=e,l=function(){var a=new g.HandlebarsEnvironment;return j.extend(a,g),a.SafeString=h,a.Exception=i,a.Utils=j,a.VM=k,a.template=function(b){return k.template(b,a)},a},m=l();return m.create=l,f=m}(d,a,c,b,e);return f}();Handlebars.registerHelper("equal",function(a,b,c){if(arguments.length<3)throw new Error("Handlebars Helper equal needs 2 parameters");return a!=b?c.inverse(this):c.fn(this)}),Handlebars.registerHelper("ifCond",function(a,b,c,d){switch(b){case"==":return a==c?d.fn(this):d.inverse(this);case"===":return a===c?d.fn(this):d.inverse(this);case"<":return c>a?d.fn(this):d.inverse(this);case"<=":return c>=a?d.fn(this):d.inverse(this);case">":return a>c?d.fn(this):d.inverse(this);case">=":return a>=c?d.fn(this):d.inverse(this);case"&&":return a&&c?d.fn(this):d.inverse(this);case"||":return a||c?d.fn(this):d.inverse(this);default:return d.inverse(this)}}),this.JST=this.JST||{},this.JST["app-summary-yesterday"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='    <div class="widget-title bg_ly"\n         href="#collapseG2">\n        <h5>用户概况</h5>\n        <span class="icon">\n            <i class="ico-question-mark"\n               data-content="<p>新增用户数：新增的设备数，卸载重装不算作新增。</p><p>日活用户数：当日在前台使用过应用的设备数。</p><p>启动次数：当日应用启动在前台的次数，相邻2次启动的时间间隔如果在30秒内会视为一次启动。</p><p>月活用户数：最近30天内（不含今天）至少启动过一次应用的设备数。</p><p>累计总用户数：开始使用小米统计服务后所有新增用户的总和。</p><p>今日数据为今日截止目前该统计项的累计数值，今日数据每5分钟更新一次。</p>"\n               data-toggle="tooltip">\n            </i>\n        </span>\n    </div>\n    <div class="widget-content nopadding collapse in"\n         id="collapseG2">\n        <div class="container-fluid user-statistics">\n            <div class="left">\n                <div class="yesterday-div">\n                    <span class="yesterday-div-tip">\n                        昨日\n                    </span>\n                </div>\n                <div class="today-div">\n                    <span class="today-div-tip">\n                        今日\n                    </span>\n                </div>\n            </div>\n            <div class="right">\n\n                <div class="span">\n                    <div class="yesterday-div">\n                        <span>新增</span>\n                        <span class="number" title="'+i((f=b&&b.nu,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.nu,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'</span>\n                        <div class="'+i((f=b&&b.nu,f=null==f||f===!1?f:f.changeType,typeof f===h?f.apply(b):f))+'">\n                            <i class="ico-summary-up-arrow"></i>\n                            <span class="change-num" title="'+i((f=b&&b.nu,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.nu,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'</span>\n                            <span class="change-ratio" title="'+i((f=b&&b.nu,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+'">('+i((f=b&&b.nu,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+')</span>\n                        </div>\n                    </div>\n\n                    <div class="today-nu today-div">\n                        <div class="placeholder"></div>\n                    </div>\n                </div>\n                <div class="span">\n                    <div class="yesterday-div">\n                        <span>日活</span>\n                        <span class="number" title="'+i((f=b&&b.aud,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.aud,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'</span>\n                        <div class="'+i((f=b&&b.aud,f=null==f||f===!1?f:f.changeType,typeof f===h?f.apply(b):f))+'">\n                            <i class="ico-summary-up-arrow"></i>\n                            <span class="change-num" title="'+i((f=b&&b.aud,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.aud,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'</span>\n                            <span class="change-ratio" title="'+i((f=b&&b.aud,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+'">('+i((f=b&&b.aud,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+')</span>\n                        </div>\n                    </div>\n\n                    <div class="today-aud today-div">\n                        <div class="placeholder"></div>\n                    </div>\n                </div>\n                <div class="span">\n                    <div class="yesterday-div">\n                        <span>启动</span>\n                        <span class="number" title="'+i((f=b&&b.stime,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.stime,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'</span>\n                        <div class="'+i((f=b&&b.stime,f=null==f||f===!1?f:f.changeType,typeof f===h?f.apply(b):f))+'">\n                            <i class="ico-summary-up-arrow"></i>\n                            <span class="change-num" title="'+i((f=b&&b.stime,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.stime,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'</span>\n                            <span class="change-ratio" title="'+i((f=b&&b.stime,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+'">('+i((f=b&&b.stime,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+')</span>\n                        </div>\n                    </div>\n\n                    <div class="today-stime today-div">\n                        <div class="placeholder"></div>\n                    </div>\n                </div>\n                <div class="span">\n                    <div class="yesterday-div">\n                        <span>月活</span>\n                        <span class="number" title="'+i((f=b&&b.aum,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.aum,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'</span>\n                        <div class="'+i((f=b&&b.aum,f=null==f||f===!1?f:f.changeType,typeof f===h?f.apply(b):f))+'">\n                            <i class="ico-summary-up-arrow"></i>\n                            <span class="change-num" title="'+i((f=b&&b.aum,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.aum,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'</span>\n                            <span class="change-ratio" title="'+i((f=b&&b.aum,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+'">('+i((f=b&&b.aum,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+')</span>\n                        </div>\n                    </div>\n                    <div class="today-aum today-div">\n                        <div class="placeholder"></div>\n                    </div>\n                </div>\n                <div class="span">\n                    <div class="yesterday-div">\n                        <span>累计</span>\n                        <span class="number" title="'+i((f=b&&b.u,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.u,f=null==f||f===!1?f:f.num,typeof f===h?f.apply(b):f))+'</span>\n                        <div class="'+i((f=b&&b.u,f=null==f||f===!1?f:f.changeType,typeof f===h?f.apply(b):f))+'">\n                            <i class="ico-summary-up-arrow"></i>\n                            <span class="change-num" title="'+i((f=b&&b.u,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'">'+i((f=b&&b.u,f=null==f||f===!1?f:f.change,typeof f===h?f.apply(b):f))+'</span>\n                            <span class="change-ratio" title="'+i((f=b&&b.u,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+'">('+i((f=b&&b.u,f=null==f||f===!1?f:f.ratio,typeof f===h?f.apply(b):f))+')</span>\n                        </div>\n                    </div>\n                    <div class="today-u today-div">\n                        <div class="placeholder"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n'}),this.JST=this.JST||{},this.JST["top-ten-bar-diagram"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n            <span class="icon">\n            <i class="ico-question-mark"\n               data-content="',(e=c.hovertip)?d=e.call(a,{hash:{},data:b}):(e=a&&a.hovertip,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+'"\n               data-toggle="tooltip">\n            </i>\n        </span>\n        '}function g(a,b){var d,e,f="";return f+='\n                <li>\n                    <div class="row-fluid">\n                        <div class="span2" title="',(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+'">',(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+'</div>\n                        <div class="span7">\n                            <div class="progress progress-blue">\n                                <div style="width: ',(e=c.ratio)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ratio,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+';" class="bar"></div>\n                            </div>\n                        </div>\n                        <div class="span3 pagination-right" title="',(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+"|",(e=c.ratio)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ratio,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+'">\n                            <span class="num">',(e=c.num)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+'</span>\n                            <span class="vertical-line-placeholder">|</span>\n                            <span class="percentage">',(e=c.ratio)?d=e.call(a,{hash:{},data:b}):(e=a&&a.ratio,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+"</span>\n                        </div>\n                    </div>\n                </li>\n            "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j="",k="function",l=this.escapeExpression,m=this;return j+='\n\n<div class="widget-box">\n    <div class="widget-title bg_lo" data-toggle="collapse"\n         href="#collapseG3">\n        <h5>',(i=c.title)?h=i.call(b,{hash:{},data:e}):(i=b&&b.title,h=typeof i===k?i.call(b,{hash:{},data:e}):i),j+=l(h)+"</h5>\n        ",h=c["if"].call(b,b&&b.showQeustionMark,{hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e}),(h||0===h)&&(j+=h),j+='\n\n    </div>\n    <div class="widget-content updates collapse in"\n        >\n        <ul class="unstyled">\n            ',h=c.each.call(b,b&&b.topTenArray,{hash:{},inverse:m.noop,fn:m.program(3,g,e),data:e}),(h||0===h)&&(j+=h),j+="\n\n        </ul>\n    </div>\n</div>\n"}),function(){$.MODEL||($.MODEL={});var a=function(a){a=a||{};for(var b in a)a.hasOwnProperty(b)&&(a=a[b]);var c=a.u||{},d=a.nu||{},e=a.aud||{},f=a.stime||{},g=a.aum||{},h={"+":"up"};return c.changeType=h[c.flag]||"down",d.changeType=h[d.flag]||"down",e.changeType=h[e.flag]||"down",f.changeType=h[f.flag]||"down",g.changeType=h[g.flag]||"down",{u:c,nu:d,aud:e,stime:f,aum:g}},b=function(a){a=a||{};var b={},c=a.type,d=a.interval,e=a.before,f=a.current,g={1:"昨日数据",7:"7日前数据",30:"30日前数据"},h={name:"今日数据",data:[]},i={name:g[d],data:[]};return b.categories=["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],b.series=[],i.data=e,h.data=f,b.series.push(h),d&&b.series.push(i),{drawData:b,type:c,interval:d}},c=function(a){a=a||{};var b={categories:[],series:[{data:[]}]},c={};for(var d in a)$.isPlainObject(a[d])&&(c=a[d],a.type=d);for(var d in c)if(c.hasOwnProperty(d)){var e=date("%m/%d",parseFloat(d));b.categories.push(e),b.series[0].data.push({name:e,y:c[d]})}switch(a.interval){case 7:b.series[0].name="7天趋势数据";break;case 14:b.series[0].name="14天趋势数据";break;case 30:b.series[0].name="30天趋势数据";break;case 0:a.begintsProcessed=date("%Y-%n-%j",a.beginTs),a.endtsProcessed=date("%Y-%n-%j",a.endTs),b.series[0].name=a.begintsProcessed+"到"+a.endtsProcessed+"趋势数据"}return a.drawData=b,a},d=function(a){a=a||{};var b=(a.max,a.channels||[]),c={},d=[];return $.each(b,function(a,b){c={name:b[0],num:b[1],ratio:b[2]},d.push(c)}),d};$.MODEL["app-summary-model"]={processYesterdayData:a,processRealtimeData:b,processTrendData:c,processTopTenData:d}}(),function(){"use strict";function a(a,b,c){this.success({errorCode:a.status,reason:c&&c.toString()})}function b(){$(".timing-chart").empty(),s.loading("show"),$.utils.request({url:"/mistats/xmstats/realtime/{appid}/{packagename}/trend",type:"POST",dataType:"json",data:{type:m,interval:n},success:function(a){a=a||{errorCode:666,reason:"empty data"};var b=a.errorCode,c=a.reason,e=a.result||{};if(0===b){if($.isEmptyObject(e))return void s.loading("error");d(e.realtime)}else s.loading("error",{errorText:"后台服务出错："+b,hoverTip:c})},error:function(){a.apply(this,arguments)}})}function c(){$(".trend-chart").empty(),u.loading("show"),$.utils.request({url:"/mistats/xmstats/trend/{appid}/{packagename}/stats",type:"POST",dataType:"json",data:{type:o,interval:p,beginTs:q,endTs:r},success:function(a){a=a||{errorCode:666,reason:"empty data"};var b=a.errorCode,c=a.reason,d=a.result||{},f=d.common||{};if(0===b){if($.isEmptyObject(f))return void u.loading("error");e(f)}else u.loading("error",{errorText:"后台服务出错："+b,hoverTip:c})},error:function(){a.apply(this,arguments)}})}function d(a){var b=l.processRealtimeData(a);switch(s.loading("hide"),drawLine(".timing-chart",b.drawData,{yAxisText:"今日实时数据对比",step:2}),$("#today-title-tab span").removeClass("active").blur(),b.type){case"nu":$("#today-title-tab span:nth-child(1)").addClass("active");break;case"stime":$("#today-title-tab span:nth-child(2)").addClass("active")}switch($("#today-btn-group button").removeClass("active").blur(),b.interval){case 0:$("#today-btn-group button:nth-child(1)").addClass("active");break;case 1:$("#today-btn-group button:nth-child(2)").addClass("active");break;case 7:$("#today-btn-group button:nth-child(3)").addClass("active");break;case 30:$("#today-btn-group button:nth-child(4)").addClass("active")}}function e(a){var b=l.processTrendData(a);u.loading("hide");var c=Math.ceil(b.drawData.categories.length/15);switch(drawLine(".trend-chart",b.drawData,{yAxisText:"趋势数据",step:c}),$("#trend-title-tab span").removeClass("active").blur(),b.type.toLowerCase()){case"nu":$("#trend-title-tab span:nth-child(1)").addClass("active");break;case"aud":$("#trend-title-tab span:nth-child(2)").addClass("active");break;case"stime":$("#trend-title-tab span:nth-child(3)").addClass("active")}switch($("#trend-btn-group button").removeClass("active").blur(),b.interval){case 0:$('input[name="daterange"]').val(date("%Y/%m/%d",b.beginTs)+" - "+date("%Y/%m/%d",b.endTs));break;case 30:$("#trend-btn-group button:nth-child(3)").addClass("active");break;case 7:$("#trend-btn-group button:nth-child(1)").addClass("active");break;case 14:$("#trend-btn-group button:nth-child(2)").addClass("active")}}function f(a){var b=l.processTopTenData(a),c=window.JST["top-ten-bar-diagram"]({title:"新增用户TOP10渠道",hovertip:"<p>昨天新增用户数前10的渠道、该渠道新增用户数量和在昨日总体新增用户中的占比。</p>",topTenArray:b,showQuestionMark:!0});v.loading("hide"),$("#new-added-user-top-ten-container").html(c),$("[data-toggle=tooltip]").popover({animation:!0,html:!0,placement:"right",trigger:"hover"})}function g(a){var b=l.processTopTenData(a),c=window.JST["top-ten-bar-diagram"]({title:"日活跃用户TOP10渠道",hovertip:"<p>昨天日活用户数前10的渠道、该渠道日活用户数量和在昨日总体日活用户中的占比。</p>",topTenArray:b,showQuestionMark:!0});w.loading("hide"),$("#day-active-user-top-ten-container").html(c),$("[data-toggle=tooltip]").popover({animation:!0,html:!0,placement:"right",trigger:"hover"})}function h(){$.utils.request({url:"/mistats/xmstats/realtime/{appid}/{packagename}/current",type:"POST",dataType:"json",success:function(a){a=a||{errorCode:666,reason:"empty data"};var b,c,d,e,f,g,h=a.errorCode,l=a.reason,m=a.result||{};if(0===h){if($.isEmptyObject(m))return;for(var n in m)m=m[n];if(m&&(b=m.nu,d=m.stime,f=m.au),null!=b)if(c=$(".today-nu"),c.find(".placeholder").length>0)c.html('新增<span class="today-div-num" title="'+b+'">'+b+"</span>"),i=new Odometer({el:c.find(".today-div-num")[0],value:b,format:"",theme:"default"});else{var o=c.find(".today-div-num");i.update(b),o.attr("title",b)}if(null!=d)if(e=$(".today-stime"),e.find(".placeholder").length>0)e.html('启动<span class="today-div-num" title="'+d+'">'+d+"</span>"),j=new Odometer({el:e.find(".today-div-num")[0],value:d,format:"",theme:"default"});else{var p=e.find(".today-div-num");j.update(d),p.attr("title",d)}if(null!=f)if(g=$(".today-aud"),g.find(".placeholder").length>0)g.html('日活<span class="today-div-num" title="'+f+'">'+f+"</span>"),k=new Odometer({el:g.find(".today-div-num")[0],value:f,format:"",theme:"default"});else{var q=g.find(".today-div-num");k.update(f),q.attr("title",f)}}else t.loading("error",{errorText:"后台服务出错："+h,hoverTip:l})},error:function(){a.apply(this,arguments)}})}var i,j,k,l=$.MODEL["app-summary-model"],m="nu",n=1,o="nu",p=7,q=0,r=0,s=null,t=null,u=null,v=null,w=null,x={initFlag:!1,initEventFlag:!1,init:function(){x.initFlag?($.utils.request({url:"/mistats/xmstats/common/{appid}/{packagename}/desc",type:"POST",dataType:"json",success:function(a){a=a||{errorCode:666,reason:"empty data"};var b=a.errorCode,c=a.reason,d=a.result||{};if(0===b){if($.isEmptyObject(d))return void t.loading("error");var e=window.JST["app-summary-yesterday"](l.processYesterdayData(d));t.loading("hide"),$("#app-summary-yesterday-stas").html(e),h(),window.setInterval(function(){h()},3e4),$("[data-toggle=tooltip]").popover({animation:!0,html:!0,placement:"right",trigger:"hover"})}else t.loading("error",{errorText:"后台服务出错："+b,hoverTip:c})},error:function(){a.apply(this,arguments)}}),b(),$.utils.request({url:"/mistats/xmstats/channel/{appid}/{packagename}/topn",type:"POST",dataType:"json",data:{type:"aud,nu"},success:function(a){a=a||{errorCode:666,reason:"empty data"};var b=a.errorCode,c=a.reason,d=a.result||{},e=d.top||{},h=e.nu||{},i=h.channels,j=e.aud||{},k=j.channels;0===b?(!$.isEmptyObject(h)&&i&&i[0]?f(h):v.loading("error"),!$.isEmptyObject(j)&&k&&k[0]?g(d.top.aud):w.loading("error")):(v.loading("error",{errorText:"后台服务出错："+b,hoverTip:c}),w.loading("error",{errorText:"后台服务出错："+b,hoverTip:c}))},error:function(){a.apply(this,arguments)}}),c()):(s=$("#today-timing-data .widget-content").loading(),u=$("#trend-data .widget-content").loading(),t=$("#app-summary-yesterday-stas .widget-content").loading(),t.loading("show"),v=$("#new-added-user-top-ten-container .widget-content").loading(),v.loading("show"),w=$("#day-active-user-top-ten-container .widget-content").loading(),w.loading("show"),x.initFlag=!0,$.utils.checkLogin(x.init),x.initEventHandler())},initEventHandler:function(){$("#today-timing-data .widget-content .btn").click(function(){var a=$(this),c=a.data("interval");$("#today-btn-group button").removeClass("active"),a.addClass("active"),n=c,b()}),$.sub("tab-change",function(a,d){var e=d.tab;switch(e){case"today-realtime-new-added-user":m="nu",b();break;case"today-realtime-start-time":m="stime",b();break;case"trend-new-added-user":o="nu",c();break;case"trend-day-active-user":o="aud",c();break;case"trend-start-time":o="stime",c()}}),$("#trend-data .widget-content .btn").click(function(){var a=$(this),b=a.data("interval");switch($("#trend-btn-group button").removeClass("active"),a.addClass("active"),b){case 7:p=7;break;case 14:p=14;break;case 30:p=30}c()});var a=new Date(+new Date-864e5);$('input[name="daterange"]').daterangepicker({format:"YYYY/MM/DD",startDate:a,endDate:a,maxDate:a},function(a,b){$.pub("date-range-change",{start:a,end:b})}).val(date("%Y/%m/%d",+new Date-864e5)+" - "+date("%Y/%m/%d",+new Date-864e5)),$.sub("date-range-change",function(a,b){var d=b.start._d.valueOf(),e=b.end._d.valueOf()+1-864e5;e-d>=0&&2592e7>=e-d?(q=d,r=e,p=0,c()):(alert("结束时间必须大于等于开始时间，最大时间间隔为300天，请重新选择"),$('input[name="daterange"]').data("daterangepicker").setStartDate(date("%Y/%m/%d",q||+new Date-864e5)),$('input[name="daterange"]').data("daterangepicker").setEndDate(date("%Y/%m/%d",r||+new Date-864e5)),$('input[name="daterange"]').val(date("%Y/%m/%d",q||+new Date-864e5)+" - "+date("%Y/%m/%d",r||+new Date-864e5)))})}};x.init()}();